(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},106:function(e,t){},108:function(e,t){},141:function(e,t){},142:function(e,t){},207:function(e,t,a){},209:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(92),c=a.n(r),s=(a(100),a(7)),i=a(8),l=a(16),m=a(14),u=a(15),d=a(29),h=a(17),f=(a(48),a(93)),v=a.n(f),p=a(94),g=a.n(p),k=(a(207),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).blockShows=0,a.state={renderFlag:1},a.demos=[],a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",function(){1!==e.blockShows||e.__click_on_more_projects__||(e.blockShows=0,e.refs.mp.style.display="",e.refs.ob.className=e.refs.ob.className.replace(/ open/g,""),e.refs.mp.className=e.refs.mp.className.replace(/ open/g,"")),e.__click_on_more_projects__=0}),this.loadDemos()}},{key:"loadDemos",value:function(){var e=this;v()({method:"get",url:"https://georgechenzj.github.io/static/demos.json",responseType:"json"}).then(function(t){try{e.demos=t.data.demos,e.setState(function(e){return{renderFlag:~e.renderFlag}})}catch(a){console.warn(a),console.error("Data format error")}}).catch(function(e){console.warn(e)})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"header"},o.a.createElement("img",{src:g.a,className:"header-logo",alt:"logo"}),o.a.createElement("div",{className:"header-title"},this.props.title," @David Albert"),o.a.createElement("div",{className:"options",onClick:function(){return e.moreProjects()},ref:"ob"},o.a.createElement("div",{className:"options-text"},"More Projects"),o.a.createElement("div",{className:"options-btn"})),o.a.createElement("div",{className:"more-projects",ref:"mp",onClick:function(){e.__click_on_more_projects__=1}},o.a.createElement("div",{className:"btn-placeholder",onClick:function(){return e.moreProjects()}}),o.a.createElement("div",{className:"mp-hide-scroll",ref:"mpscroll"},o.a.createElement("div",{className:"mp-content"},o.a.createElement("div",{className:"mp-welcome"},o.a.createElement("div",{className:"mp-welcome-content"},o.a.createElement("div",{className:"mp-welcome-ball-ct"},o.a.createElement("div",{className:"mp-welcome-ball-r1"},o.a.createElement("div",{className:"mp-welcome-ball1"},o.a.createElement("div",{className:"mp-welcome-ball-r2"},o.a.createElement("div",{className:"mp-welcome-ball2"}))))),o.a.createElement("div",{className:"mp-welcome-text"},"Hi! Let's discover more fun projects."))),o.a.createElement("div",{className:"mp-demos",ref:"demos"},this.demos.map(function(e,t){return e.title?o.a.createElement(b,{title:e.title,desc:e.desc,source:e.preview,link:e.link,key:t}):null}))))))}},{key:"moreProjects",value:function(){var e=this;this.__click_on_more_projects__=1,this.blockShows?(this.blockShows=0,this.refs.mp.style.display="",this.refs.ob.className=this.refs.ob.className.replace(/ open/g,""),this.refs.mp.className=this.refs.mp.className.replace(/ open/g,"")):(this.refs.mp.style.display="block",this.refs.mpscroll.scrollTop=0,setTimeout(function(){e.blockShows=1,e.refs.ob.className+=" open",e.refs.mp.className+=" open"},50))}}]),t}(n.Component)),b=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={ready:0,error:0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"visit",value:function(){this.props.link&&window.open(this.props.link)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"demo"},o.a.createElement("div",{className:"demo-title"},this.props.title),o.a.createElement("div",{className:"demo-desc"},this.props.desc),this.props.source?o.a.createElement("div",{className:"demo-img-frame"},o.a.createElement("img",{src:this.props.source,className:"demo-img",alt:"",title:this.props.title,style:{visibility:this.state.ready&&!this.state.error?"visible":"hidden"},onLoad:function(){return e.setState({ready:1})},onError:function(){return e.setState({error:1})},onClick:function(){return e.visit()}}),this.state.ready&&!this.state.error?"":o.a.createElement("img",{src:"static/img/loading.gif",className:"demo-img-loading",alt:"loading",onClick:function(){return e.visit()}})):o.a.createElement("div",{className:"demo-img-frame"},o.a.createElement("div",{className:"demo-plaintext",onClick:function(){return e.visit()},title:this.props.title},o.a.createElement("img",{className:"demo-texticon",src:"static/img/texticon.png",alt:""}))))}}]),t}(n.Component),E=k,N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).mode=1,a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"setMode",value:function(e){this.mode=e}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"cursor",ref:"cursor"}),o.a.createElement("canvas",{width:512,height:512,className:"draw",ref:"element",onMouseDown:function(t){e.onMouseDown(t)},onTouchStart:function(t){e.onMouseDown(t)},onMouseMove:function(t){e.onMouseMove(t)},onMouseEnter:function(t){e.onMouseEnter(t)},onMouseLeave:function(t){e.onMouseLeave(t)}}))}},{key:"clear",value:function(){var e=this.refs.element.getContext("2d");e.fillStyle="white",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.beginPath()}},{key:"computePosition",value:function(e){var t=[0,0];do{t[0]+=e.offsetLeft,t[1]+=e.offsetTop,e=e.parentNode}while(e!==document.body);return t}},{key:"onMouseMove",value:function(e){e.preventDefault(),this.onCursor&&this.moveCursor(e)}},{key:"onMouseDown",value:function(e){e.preventDefault(),this.basicDraw(e,this.mode)}},{key:"onMouseEnter",value:function(e){e.preventDefault();var t=this.refs.cursor,a=new Image;a.width=20,a.height=20,1===this.mode?a.src="static/img/pencil.svg":0===this.mode&&(a.src="static/img/rubber.svg"),a.alt="",a.onload=function(){t.appendChild(a),t.className+=" on"},this.onCursor=!0}},{key:"onMouseLeave",value:function(){this.onCursor=!1;var e=this.refs.cursor;e.className="cursor",e.innerHTML=""}},{key:"moveCursor",value:function(e){var t=e.clientX||(e.changedTouches?e.changedTouches[0].clientX:0),a=e.clientY||(e.changedTouches?e.changedTouches[0].clientY:0),n=this.refs.cursor;n.style.top=a+"px",n.style.left=t+"px"}},{key:"basicDraw",value:function(e,t){var a,n,o,r,c,s,i=this,l=e.pageX||(e.changedTouches?e.changedTouches[0].pageX:0),m=e.pageY||(e.changedTouches?e.changedTouches[0].pageY:0),u=!1,d=function(e){e.preventDefault();var d=e.pageX||(e.changedTouches?e.changedTouches[0].pageX:0),h=e.pageY||(e.changedTouches?e.changedTouches[0].pageY:0);!u&&Math.abs(h-m)<4&&Math.abs(d-l)<4||(u||(u=!0,a=i.refs.element,n=i.computePosition(a),s=n[1]-a.scrollTop,c=n[0]-a.scrollLeft,(r=i.refs.element.getContext("2d")).beginPath(),r.moveTo(l-c,m-s),o=setInterval(function(){r.stroke()},30),0===t?(r.lineWidth=15,r.strokeStyle="#fff"):(r.lineWidth=1,r.strokeStyle="#000")),r.lineTo(d-c,h-s))},h=function(e){e.preventDefault()},f=function e(t){document.removeEventListener("touchmove",h,{passive:!1}),document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseup",e,!1),document.removeEventListener("touchmove",d,!1),document.removeEventListener("touchend",e,!1),document.removeEventListener("touchcancel",e,!1),u&&(clearInterval(o),r.stroke())};document.addEventListener("touchmove",h,{passive:!1}),document.addEventListener("mousemove",d,!1),document.addEventListener("mouseup",f,!1),document.addEventListener("touchmove",d,!1),document.addEventListener("touchend",f,!1),document.addEventListener("touchcancel",f,!1)}}]),t}(n.Component),y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={renderFlag:0,hasUnusedFrame:!0},a.frames=[],a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.addFrame()}},{key:"getSketch",value:function(){return this.refs.draw.refs.element}},{key:"getColour",value:function(){return this.pickedColour?this.pickedColour.slice():null}},{key:"pickColour",value:function(e){this.pickedColour=e.slice()}},{key:"pickTool",value:function(e){"RUBBER"===e?this.refs.draw.setMode(0):"PENCIL"===e&&this.refs.draw.setMode(1)}},{key:"addFrame",value:function(){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",t=e.length,a="",n=0;n<8;n++)a+=e.charAt(Math.floor(Math.random()*t));this.frames.unshift(a),this.setState(function(e){return{renderFlag:~e.renderFlag,hasUnusedFrame:!0}})}},{key:"getUnusedFrame",value:function(){return this.refs[String(this.frames[0])]}},{key:"update",value:function(){this.refs[String(this.frames[0])].state.used&&this.setState({hasUnusedFrame:!1})}},{key:"rotate",value:function(){var e=this;this.contour_n?++this.contour_n:this.contour_n=1;var t="static/img/"+this.contour_n+".jpg";window.App.addContour(t,function(){e.contour_n=0,e.rotate()})}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"studio"},o.a.createElement("div",{className:"frame frame-input",style:{position:"relative",backgroundImage:"url(static/img/timg.jpg)"}},o.a.createElement("div",{className:"toolkit"},o.a.createElement("div",{className:"tool"},o.a.createElement("input",{className:"tool-radio",onChange:function(){return e.pickTool("RUBBER")},type:"radio",name:"pick-tool"}),o.a.createElement("div",{className:"tool-manifest"},o.a.createElement("img",{className:"tool-icon",src:"static/img/rubber.svg",alt:""}))),o.a.createElement("div",{className:"tool"},o.a.createElement("input",{className:"tool-radio",onChange:function(){return e.pickTool("PENCIL")},type:"radio",name:"pick-tool",defaultChecked:!0}),o.a.createElement("div",{className:"tool-manifest"},o.a.createElement("img",{className:"tool-icon",src:"static/img/pencil.svg",alt:""}))),o.a.createElement("div",{className:"tool right"},o.a.createElement("input",{className:"tool-radio ckeckbox",onChange:function(){return e.refs.draw.clear()},type:"checkbox",name:"clear"}),o.a.createElement("div",{className:"tool-manifest"},o.a.createElement("img",{className:"tool-icon",src:"static/img/clear.png",alt:""}))),o.a.createElement("div",{className:"tool right"},o.a.createElement("input",{className:"tool-radio ckeckbox",onChange:function(){return e.rotate()},type:"checkbox",name:"clear"}),o.a.createElement("div",{className:"tool-manifest"},o.a.createElement("img",{className:"tool-icon",src:"static/img/rotate.png",alt:""})))),o.a.createElement(N,{ref:"draw"})),o.a.createElement("div",{className:"display",ref:"display"},o.a.createElement("div",{className:"colour-picker",style:{display:this.state.hasUnusedFrame?"":"none"}},o.a.createElement("div",{className:"colour-block"},o.a.createElement("input",{className:"colour-picker-radio",onChange:function(){e.pickColour([20,20,200])},type:"radio",name:"pick-colour",defaultChecked:!0}),o.a.createElement("div",{className:"colour-block-bg",style:{backgroundColor:"rgb(20, 20, 200)"}})),o.a.createElement("div",{className:"colour-block"},o.a.createElement("input",{className:"colour-picker-radio",onChange:function(){e.pickColour([200,20,20])},type:"radio",name:"pick-colour"}),o.a.createElement("div",{className:"colour-block-bg",style:{backgroundColor:"rgb(200, 20, 20)"}})),o.a.createElement("div",{className:"colour-block"},o.a.createElement("input",{className:"colour-picker-radio",onChange:function(){e.pickColour([250,250,250])},type:"radio",name:"pick-colour"}),o.a.createElement("div",{className:"colour-block-bg",style:{backgroundColor:"rgb(250, 250, 250)"}})),o.a.createElement("div",{className:"colour-block"},o.a.createElement("input",{className:"colour-picker-radio",onChange:function(){e.pickColour([130,130,130])},type:"radio",name:"pick-colour"}),o.a.createElement("div",{className:"colour-block-bg",style:{backgroundColor:"rgb(130, 130, 130)"}})),o.a.createElement("div",{className:"colour-block"},o.a.createElement("input",{className:"colour-picker-radio",onChange:function(){e.pickColour([20,20,20])},type:"radio",name:"pick-colour"}),o.a.createElement("div",{className:"colour-block-bg",style:{backgroundColor:"rgb(20, 20, 20)"}}))),o.a.createElement("button",{className:"btn-add-frame",onClick:function(){return e.addFrame()},style:{display:this.state.hasUnusedFrame?"none":""}},"+"),this.frames.map(function(e,t){return o.a.createElement(w,{ref:e,key:e})}))))}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={used:!1},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"use",value:function(){this.setState({used:!0})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"frame"},o.a.createElement("canvas",{width:256,height:256,className:"output",ref:"canvas"}),this.state.used?null:o.a.createElement("div",{className:"output-control"},o.a.createElement("button",{className:"btn-go",onClick:function(){window.App.generate(e)}},"GO")))}}]),t}(n.Component),C=y,j=function(){function e(t,a){Object(s.a)(this,e);var n,o;if("IMAGE"===t.tagName){t.width=256,t.height=256;var r=document.createElement("canvas");r.width=256,r.height=256,(n=r.getContext("2d")).drawImage(t,0,0),o=n.getImageData(0,0,256,256).data}else if("CANVAS"===t.tagName)if(256!==t.width||256!==t.height){var c=document.createElement("canvas");c.width=256,c.height=256;var i=c.getContext("2d");i.drawImage(t,0,0,256,256),o=i.getImageData(0,0,256,256).data}else o=n.getImageData(0,0,256,256).data;for(var l=new Uint8Array(new ArrayBuffer(65536),0,65536),m=0,u=0;u<o.length;u+=4)l[m++]=o[u]>128?0:2;this.contour=l,this.colour=a||[255,255,255]}return Object(i.a)(e,[{key:"getInput",value:function(){var e=this.colour;e[0]=e[0]/255*2-1,e[1]=e[1]/255*2-1,e[2]=e[2]/255*2-1;for(var t=this.contour,a=new Float32Array(new ArrayBuffer(1048576),0,262144),n=0,o=0;o<a.length;o+=4)a[o]=e[0],a[o+1]=e[1],a[o+2]=e[2],a[o+3]=t[n++]-1;return h.c(a,[1,256,256,4])}}]),e}(),O=a(22),_=function(){function e(t){Object(s.a)(this,e),this.load(function(){console.log("Model loaded"),t()})}return Object(i.a)(e,[{key:"run",value:function(e){var t=new j(e.sketch,e.colour).getInput();return this.model.execute({input:t})}},{key:"load",value:function(e){var t=this;Object(O.a)("static/model/JS_MODEL_1/tensorflowjs_model.pb","static/model/JS_MODEL_1/weights_manifest.json").then(function(a){t.model=a,e()},function(e){console.log(e)})}}]),e}(),M=function(e){function t(e){var a;return Object(s.a)(this,t),a=Object(l.a)(this,Object(m.a)(t).call(this,e)),window.App=Object(d.a)(Object(d.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.model=new _(function(){e.refs.loading.className+=" off"}),this.addContour("static/img/2.jpg")}},{key:"generate",value:function(e,t){var a=this;if(!this.model)return alert("Model not loaded");window.timestart=(new Date).getTime();var n=this.model.run({sketch:this.refs.studio.getSketch(),colour:this.refs.studio.getColour()||[58,60,200]});console.log("elapsed: "+((new Date).getTime()-window.timestart));var o=e.refs.canvas;h.d(h.b(h.a(n,"int32"),[256,256,3]),o),console.log("elapsed: "+((new Date).getTime()-window.timestart)),e.use(),setTimeout(function(){a.refs.studio.update()},100)}},{key:"addContour",value:function(e,t){var a=this,n=new Image(256,256);n.src=e,n.onload=function(){var e=document.createElement("canvas");e.width=256,e.height=256;var t=e.getContext("2d");t.drawImage(n,0,0);for(var o=t.getImageData(0,0,256,256).data,r=new Uint8Array(new ArrayBuffer(65536),0,65536),c=0,s=0;s<o.length;s+=4)r[c++]=o[s]>128?255:0;h.d(h.b(h.a(r,"int32"),[256,256,1]),e).then(function(){var t=a.refs.studio.getSketch();t.getContext("2d").drawImage(e,0,0,t.width,t.height)})},n.onerror=function(e){t()}}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(E,{title:"Draw A Car",ref:"header"}),o.a.createElement("div",{className:"main-body",style:{position:"relative",backgroundImage:"url(static/img/bg.jpg)"}},o.a.createElement(C,{ref:"studio"})),o.a.createElement("footer",{className:"App-footer"}),o.a.createElement("div",{className:"loading",ref:"loading"},o.a.createElement("span",{className:"loading-text"},"Loading...",o.a.createElement("br",null),o.a.createElement("span",{style:{fontSize:20}},"\u6b63\u5728\u52a0\u8f7d..."))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e,t,a){},94:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},95:function(e,t,a){e.exports=a(209)}},[[95,2,1]]]);
//# sourceMappingURL=main.5273e391.chunk.js.map